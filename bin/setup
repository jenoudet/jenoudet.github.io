#!/bin/bash
# Script to automate the setting up process

set -e

# Remove marks of previous attempt if they exist
rm -rf env/ node_modules/
# Create new virtual env
python3 -m venv env
source env/bin/activate
pip install --upgrade pip setuptools wheel
# Install nodeenv package
pip install nodeenv
nodeenv --python-virtualenv
deactivate
source env/bin/activate
# Install front and backend
pip install -e .
pip install httpie
npm install .
# Install chromedriver
CHROMEDRIVER_VERSION=`curl https://chromedriver.storage.googleapis.com/LATEST_RELEASE`
CHROMEDRIVER_ARCH=linux64
wget https://chromedriver.storage.googleapis.com/${CHROMEDRIVER_VERSION}/chromedriver_${CHROMEDRIVER_ARCH}.zip
unzip chromedriver_linux64.zip
mv chromedriver env/bin/
rm chromedriver_*.zip
# Just for good measure
deactivate
source env/bin/activate
